var shuffle;shuffle=function(arr){var ci,ri,tmp;ci=arr.length;while(0!==ci){ri=Math.floor(Math.random()*ci);ci-=1;tmp=arr[ci];arr[ci]=arr[ri];arr[ri]=tmp}return arr};angular.module("daisy",["ngRoute","angular-carousel"]).filter("unsafe",function($sce){return function(val){return $sce.trustAsHtml(val)}}).run(function($route,$rootScope,$location,helper){var original;original=$location.path;return $location.path=function(path,reload){var lastRoute,un;if(reload===false){lastRoute=$route.current;un=$rootScope.$on("$locationChangeSuccess",function(){$route.current=lastRoute;return un()})}return original.apply($location,[path])}}).config(function($routeProvider){$routeProvider.when("/",{templateUrl:"/views/lights.html",controller:"LightsCtrl",controllerAs:"vm"}).when("/lights",{templateUrl:"/views/lights.html",controller:"LightsCtrl",controllerAs:"vm"}).when("/lights/:name",{templateUrl:"/views/lights.html",controller:"LightsCtrl",controllerAs:"vm"}).otherwise;return{redirectTo:"/lights"}}).factory("helper",function($http){var obj;obj={};$http.get("/js/lights.json",{cache:true}).success(function(rs){obj.lights=rs;return obj.load=true});return obj}).controller("LightsCtrl",function($window,$location,$routeParams,$anchorScroll,$timeout,$interval,helper){var light,name,stop1,vm,_i,_len,_ref;vm=this;vm.q={};vm.related=[];if(!vm.lights){vm.lights=$window.lights}vm.cts={par:"LED PAR",city:"City Color",moving:"Moving Heads",washer:"LED Wall Washer",other:"Other"};vm.wts=["1W","3W","5W","10W","12W","15W","other"];vm.mks=["s3","s4","s5","m2","m3","m4","m5","m6","ip20","ip65","ip67","sd","wl","dmx","charge"];vm.ats=["Flat PAR","INDOOR","OUTDOOR","FULL COLOR","SINGLE COLOR","OTHER"];vm.closes=function(){vm.on=false;return $timeout(function(){$location.hash("top");$anchorScroll();$location.path("/",false);return vm.light=""},200)};vm.init=function(){var stop;return stop=$interval(function(){if(helper.lights){$interval.cancel(stop);stop=null;return vm.lights=helper.lights}},250)};vm.category=function(category){vm.open=false;vm.q={c:category};return vm.c=vm.cts[category]};vm.mark=function(mark){vm.closes();vm.q={ms:mark};return vm.c=""};vm.tag=function(tag){vm.closes();vm.q={ts:tag};return vm.c=tag};vm.view=function(light){var len,pos;vm.on=true;vm.light=light;vm.is=vm.light.is.toString();len=vm.lights.length-4;pos=Math.floor(Math.random()*len);vm.related=vm.lights.slice(pos,pos+4);return $timeout(function(){return $location.path("/lights/"+light.n,false)},200)};vm.view2=function(light){vm.on=false;$timeout(function(){vm.light="";$location.hash("top");return $anchorScroll()},450);return $timeout(function(){return vm.view(light)},500)};vm.init();if(name=$routeParams.name){_ref=vm.lights;for(_i=0,_len=_ref.length;_i<_len;_i++){light=_ref[_i];if(name===light.n){vm.view(light);return}}stop1=$interval(function(){var _j,_len1,_ref1;if(helper.lights){$interval.cancel(stop1);stop1=null;_ref1=helper.lights;for(_j=0,_len1=_ref1.length;_j<_len1;_j++){light=_ref1[_j];if(name===light.n){vm.view(light);return}}}},250)}return vm});